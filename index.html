<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Bid Polish Bid 2026-2027</title>
    <link rel="stylesheet" href="bidding.css">
</head>
<body>
    <div style="background: #16213e; color: #4ecca3; padding: 8px 20px; text-align: center; font-size: 12px; border-bottom: 1px solid #0f3460;">
        üí° This page works best in Google Chrome
    </div>
    <div class="header">

        <div class="header-content">
            <h1>Pre-Bid Polish Bid 2026-2027</h1>
            <p>Bid Year: April 1, 2026 - March 31, 2027 | 12-Day Rotating Pattern</p>
            <a href="https://deltaairlines-my.sharepoint.com/:x:/r/personal/chris_pawlowski_delta_com/Documents/EXCEL%20WORK%20IN%20PROGRESS/Schedules/The%20Polish%20Bid%20Package%20%202026-2027%20(Version%201.0).xlsx?d=wc591e8c5ee294480917d9c4b1849416c&csf=1&web=1&e=J7qgMs" target="_blank" rel="noopener noreferrer" style="display:inline-block; margin-top:12px; padding:10px 20px; background:#217346; color:white; font-size:14px; font-weight:bold; text-decoration:none; border-radius:6px;">üìä Open Excel Spreadsheet (Microsoft 365)</a>
            <a href="bid_times.html" target="_blank" style="display:inline-block; margin-top:12px; margin-left:10px; padding:10px 20px; background:#c53030; color:white; font-size:14px; font-weight:bold; text-decoration:none; border-radius:6px;">‚è∞ View Official Bid Times</a>
            <a href="bid_confirmation.html" target="_blank" style="display:inline-block; margin-top:12px; margin-left:10px; padding:10px 20px; background:#9b59b6; color:white; font-size:14px; font-weight:bold; text-decoration:none; border-radius:6px;">üîí Bid Confirmations</a>
        </div>
    </div>

    <!-- Escalation Banner (hidden by default) -->
    <div id="escalationBanner" style="display:none; background:linear-gradient(135deg, #f39c12 0%, #e74c3c 100%); color:white; padding:15px 20px; text-align:center; font-weight:bold; box-shadow:0 4px 15px rgba(243,156,18,0.4);">
        <div style="font-size:18px; margin-bottom:5px;">‚ö†Ô∏è ESCALATION IN PROGRESS</div>
        <div id="escalationBannerDetails" style="font-size:14px; font-weight:normal;"></div>
    </div>

    <div class="status-bar">
        <div class="stats">
            <span style="color:#e94560; font-weight:bold; margin-right:5px;">SSOM:</span>
            <div class="stat">
                <span class="stat-label">Taken:</span>
                <span class="stat-value" id="statTakenSSOM">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Avail:</span>
                <span class="stat-value available" id="statAvailSSOM">14</span>
            </div>
            <span style="color:#e94560; font-weight:bold; margin-left:15px; margin-right:5px;">SOM:</span>
            <div class="stat">
                <span class="stat-label">Taken:</span>
                <span class="stat-value" id="statTakenSOM">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Avail:</span>
                <span class="stat-value available" id="statAvailSOM">81</span>
            </div>
            <button class="btn btn-legend" onclick="showLegend()">Legend</button>
            <button class="btn" onclick="showHolidaySummary()" style="background:#e94560; color:white;">üéÑ Holiday Summary</button>
            <button class="btn" onclick="showSwapCompare()" style="background:#9b59b6; color:white;">üîÑ Swap Compare</button>
            <button class="btn" onclick="toggleFavoritesView()" id="favoritesBtn" style="background:#f0a500; color:#1a1a2e;">‚≠ê Favorites (<span id="favCount">0</span>)</button>
            <button class="btn" onclick="showPTOModal()" style="background:#2563eb; color:white;">üèñÔ∏è PTO Overlay</button>
            <a href="swap_builder.html" class="btn" style="background:#9b59b6; color:white; text-decoration:none;">üîÑ Swap Builder</a>
            <button class="btn" onclick="toggleBidHistoryView()" id="bidHistoryBtn" style="background:#ff6b35; color:white;">üìú Bid History</button>
            <button class="btn" onclick="toggleLiveMode()" id="liveModeBtn" style="display:none; background:#16213e; color:#4ecca3; border:1px solid #4ecca3;">üî¥ Live Mode</button>
            <button class="btn" onclick="showEscalationManager()" id="escalationBtn" style="display:none; background:#f39c12; color:#1a1a2e;">üîÑ Escalation</button>
            <button class="btn" onclick="showNextYearSetup()" id="nextYearSetupBtn" style="display:none; background:#9b59b6; color:white;">‚öôÔ∏è Next Year Setup</button>
            <div class="undo-rollback-container" id="undoRollbackContainer" style="display:none; position:relative;">
                <button class="btn" onclick="toggleUndoRollbackDropdown()" id="undoRollbackBtn" style="background:#f0a500; color:#1a1a2e;">‚Ü©Ô∏è Undo Rollback ‚ñæ</button>
                <div class="undo-rollback-dropdown" id="undoRollbackDropdown"></div>
            </div>
            <span class="mode-indicator viewer" id="modeIndicator">VIEWER</span>
        </div>
        <div class="sync-status">
            <div class="sync-dot" id="syncDot"></div>
            <span id="syncText">Connecting...</span>
            <button class="btn" onclick="loadFromCloud()" style="padding:4px 12px; font-size:11px; margin-left:8px; background:#4ecca3; color:#1a1a2e; font-weight:bold;">‚ü≥ Refresh</button>
            <span style="color:#888; font-size:10px; margin-left:5px;">Auto-refreshes every 5 min | Last: <span id="lastRefresh">--</span></span>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="main-container">
            <div class="panel">
                <div class="panel-header">Seniority List</div>
                <div class="panel-content" id="seniorityPanel">
                    <div class="entry-header" id="entryHeader">
                        <span>#</span>
                        <span>Name</span>
                        <span>Line</span>
                        <span class="prev-col-header" style="display:none;">Prev</span>
                        <span></span>
                    </div>
                    <div class="group-title" id="group1Title">SSOM (14)</div>
                    <div id="group1List"></div>
                    <div class="group-title" id="group2Title">SOM (82)</div>
                    <div id="group2List"></div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">All Lines <span style="font-weight:normal; font-size:11px; color:#888;">(*Click Desc for year calendar)</span></div>
                <div class="panel-content" id="linesPanel">
                    <div class="lines-holiday-subheader">
                        <span class="spacer"></span>
                        <span></span><span></span><span></span><span></span>
                        <span></span><span></span><span></span><span></span>
                        <span></span><span></span><span></span><span></span>
                    </div>
                    <div class="lines-holiday-subheader">
                        <span class="spacer"></span>
                        <span></span><span></span><span></span><span>LABOR</span>
                        <span>XMAS</span><span></span><span></span><span></span>
                        <span></span><span></span><span></span><span>NYD</span>
                    </div>
                    <div class="lines-holiday-subheader">
                        <span class="spacer"></span>
                        <span></span><span>EAST2</span><span>STPAT</span><span>MOM</span>
                        <span>EAST1</span><span></span><span>MEMOR</span><span>SUPER</span>
                        <span></span><span>DAD</span><span>4TH</span><span>THX</span>
                    </div>
                    <div class="lines-header">
                        <span>Line</span>
                        <span>‚≠ê</span>
                        <span>Desc*</span>
                        <span>Bidder</span>
                        <span>1</span><span>2</span><span>3</span><span>4</span>
                        <span>5</span><span>6</span><span>7</span><span>8</span>
                        <span>9</span><span>10</span><span>11</span><span>12</span>
                    </div>
                    <div id="allLinesList"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div>
            <button class="btn btn-secondary" onclick="clearAll()" id="clearBtn" disabled>Clear All</button>
            <button class="btn" onclick="showAscentExport()" id="ascentBtn" style="display:none; background:#2563eb; color:white; margin-left:10px;">üì§ ASCENT Export</button>
            <button class="btn" onclick="showMaySummary()" id="maySummaryBtn" style="display:none; background:#9b59b6; color:white; margin-left:5px;">üìã May Summary</button>
            <a href="may_balance.html" id="mayBalanceBtn" class="btn" style="display:none; background:#9b59b6; color:white; margin-left:10px; text-decoration:none;">‚öñÔ∏è May Balance</a>
            <button class="btn" onclick="undoLastAction()" id="undoBtn" style="display:none; background:#f0a500; color:#1a1a2e; margin-left:10px;">‚Ü©Ô∏è Undo</button>
            <button class="btn" onclick="showAuditLog()" id="auditBtn" style="display:none; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; margin-left:10px;">üìã Audit Log</button>
        </div>
        <div>
            <button class="btn btn-admin" onclick="showPasswordModal()" id="adminBtn">Admin Login</button>
        </div>
    </div>

    <div class="modal-overlay" id="passwordModal">
        <div class="password-modal">
            <h3>üîê Admin Login</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">Enter password to enable editing</p>
            <input type="password" id="passwordInput" placeholder="Password" onkeydown="if(event.key==='Enter')checkPassword()">
            <div class="password-error" id="passwordError">Incorrect password</div>
            <button class="btn btn-primary" onclick="checkPassword()" style="width:100%; padding:12px;">Login</button>
            <button class="btn btn-secondary" onclick="hidePasswordModal()" style="width:100%; padding:12px; margin-top:10px;">Cancel</button>
        </div>
    </div>

    <div class="modal-overlay" id="legendModal" onclick="hideLegend()">
        <div class="modal" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideLegend()">Close</button>
            <h3>Legend</h3>
            <div class="legend-grid">

                <div class="legend-section">
                    <h4>Bridge Desks</h4>
                    <div class="legend-item"><span class="legend-code">N</span><span>321NEO</span></div>
                    <div class="legend-item"><span class="legend-code">O</span><span>717*</span></div>
                    <div class="legend-item"><span class="legend-code">Q</span><span>B738/B73R/B73J</span></div>
                    <div class="legend-item"><span class="legend-code">R</span><span>A220</span></div>
                    <div class="legend-item"><span class="legend-code">S</span><span>B739</span></div>
                    <div class="legend-item"><span class="legend-code">U</span><span>B763/764</span></div>
                    <div class="legend-item"><span class="legend-code">V</span><span>A321</span></div>
                    <div class="legend-item"><span class="legend-code">W</span><span>B757</span></div>
                    <div class="legend-item"><span class="legend-code">X</span><span>A319/A320</span></div>
                    <div class="legend-item"><span class="legend-code">Y</span><span>A330/A350</span></div>
                </div>
                <div class="legend-section">
                    <h4>SPT Desks</h4>
                    <div class="legend-item"><span class="legend-code">C/D/E</span><span>Terminal</span></div>
                    <div class="legend-item"><span class="legend-code">F</span><span>Routes</span></div>
                    <div class="legend-item"><span class="legend-code">G</span><span>Enroute</span></div>
                    <div class="legend-item"><span class="legend-code">H</span><span>Surface</span></div>
                    <div class="legend-item"><span class="legend-code">J/K</span><span>Regional</span></div>
                </div>
                <div class="legend-section">
                    <h4>SSOM Desks</h4>
                    <div class="legend-item"><span class="legend-code">A/B</span><span>SSOM SPT</span></div>
                    <div class="legend-item"><span class="legend-code">M/Z</span><span>SSOM Bridge</span></div>
                </div>
                <div class="legend-section">
                    <h4>2026-2027 Holidays</h4>
                    <div class="legend-item"><span class="legend-code">Pattern day 1</span><span>Super Bowl (02/14/2027)</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 2</span><span>Easter 2</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 3</span><span>St. Patrick's</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 4</span><span>Labor, Mom</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 5</span><span>Xmas, Easter 1</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 7</span><span>Memorial</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 10</span><span>Father's Day</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 11</span><span>July 4th</span></div>
                    <div class="legend-item"><span class="legend-code">Pattern day 12</span><span>NYD, Thanksgiving</span></div>
                </div>
                <div class="legend-section">
                    <h4>Status Indicators</h4>
                    <div class="legend-item"><span class="legend-code">üîí</span><span>Line Confirmed</span></div>
                </div>
            </div>
            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #0f3460; font-size: 11px; color: #888;">
                * May receive other fleets depending on daily workload of other desks
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="calendarModal" onclick="hideCalendar()">
        <div class="calendar-modal" onclick="event.stopPropagation()">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <h3 id="calendarTitle" style="margin:0;">Year Calendar</h3>
                <div>
                    <button class="btn btn-legend" onclick="toggleCalendarView()" style="margin-right:10px; background:#9b59b6; color:white;">üìÖ Toggle View</button>
                    <button class="btn btn-legend" onclick="copyCalendarLink()" style="margin-right:10px;">üîó Copy Link</button>
                    <button class="btn" onclick="exportCurrentLineICS()" style="margin-right:10px; background:#4ecca3; color:#1a1a2e;">üì• Export ICS</button>
                    <button class="btn" onclick="printCurrentLineSummary()" style="margin-right:10px; background:#2563eb; color:white;">üìÑ Summary</button>
                    <button class="btn" onclick="printCalendar()" style="margin-right:10px;">üñ®Ô∏è Print</button>
                    <button class="modal-close" onclick="hideCalendar()" style="position:relative; top:0; right:0;">Close</button>
                </div>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
            <div class="traditional-view" id="traditionalView" style="display:none;"></div>
            <div class="calendar-legend">
                <span class="calendar-legend-item" style="color:#e94560; background:rgba(233,69,96,0.2); border:1px solid #e94560;">Holiday</span>
                <span class="calendar-legend-item" style="background:#FF0000; color:#fff; border:1px solid #FF0000;">Balance Adjustment</span>
                <span class="calendar-legend-item" style="color:#2563eb; background:rgba(37,99,235,0.2); border:2px solid #2563eb;">Your PTO</span>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="holidaySummaryModal" onclick="hideHolidaySummary()">
        <div class="modal" style="max-width:1100px; width:95vw;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideHolidaySummary()">Close</button>
            <h3>üéÑ Holiday Summary - Lines with Holidays Off</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">Shows which lines have each holiday off (indicated by -- on that pattern day)</p>
            <div id="holidaySummaryContent"></div>
        </div>
    </div>

    <div class="modal-overlay" id="swapCompareModal" onclick="hideSwapCompare()">
        <div class="modal" style="max-width:1200px; width:95vw; max-height:90vh;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideSwapCompare()">Close</button>
            <h3>üîÑ Swap Compatibility Analyzer</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">Find line pairs for shift swapping (same group only, 8-hour rest rule enforced)</p>

            <!-- Manual Line Comparison -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:20px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">üìä Manual Line Comparison</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">Compare up to 5 lines side-by-side throughout the year</p>
                <div style="display:flex; gap:15px; margin-bottom:10px; flex-wrap:wrap; align-items:flex-end;">
                    <div>
                        <label style="color:#ccc; font-size:12px; display:block; margin-bottom:5px;">Line A:</label>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <input type="text" id="lineInputA" placeholder="#" maxlength="2" style="width:40px; padding:8px 4px; border-radius:5px; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; font-size:14px; text-align:center; font-weight:bold;" onkeyup="handleLineInput('A', this.value)" onchange="handleLineInput('A', this.value)">
                            <div class="custom-dropdown" id="dropdownA">
                                <div class="dropdown-selected" onclick="toggleDropdown('A')"><span>or Select</span><span style="margin-left:auto;color:#4ecca3;">‚ñº</span></div>
                                <div class="dropdown-options" id="optionsA"></div>
                                <input type="hidden" id="manualCompareLineA" value="">
                            </div>
                        </div>
                    </div>
                    <div>
                        <label style="color:#ccc; font-size:12px; display:block; margin-bottom:5px;">Line B:</label>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <input type="text" id="lineInputB" placeholder="#" maxlength="2" style="width:40px; padding:8px 4px; border-radius:5px; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; font-size:14px; text-align:center; font-weight:bold;" onkeyup="handleLineInput('B', this.value)" onchange="handleLineInput('B', this.value)">
                            <div class="custom-dropdown" id="dropdownB">
                                <div class="dropdown-selected" onclick="toggleDropdown('B')"><span>or Select</span><span style="margin-left:auto;color:#4ecca3;">‚ñº</span></div>
                                <div class="dropdown-options" id="optionsB"></div>
                                <input type="hidden" id="manualCompareLineB" value="">
                            </div>
                        </div>
                    </div>
                    <div>
                        <label style="color:#ccc; font-size:12px; display:block; margin-bottom:5px;">Line C:</label>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <input type="text" id="lineInputC" placeholder="#" maxlength="2" style="width:40px; padding:8px 4px; border-radius:5px; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; font-size:14px; text-align:center; font-weight:bold;" onkeyup="handleLineInput('C', this.value)" onchange="handleLineInput('C', this.value)">
                            <div class="custom-dropdown" id="dropdownC">
                                <div class="dropdown-selected" onclick="toggleDropdown('C')"><span>(optional)</span><span style="margin-left:auto;color:#4ecca3;">‚ñº</span></div>
                                <div class="dropdown-options" id="optionsC"></div>
                                <input type="hidden" id="manualCompareLineC" value="">
                            </div>
                        </div>
                    </div>
                    <div>
                        <label style="color:#ccc; font-size:12px; display:block; margin-bottom:5px;">Line D:</label>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <input type="text" id="lineInputD" placeholder="#" maxlength="2" style="width:40px; padding:8px 4px; border-radius:5px; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; font-size:14px; text-align:center; font-weight:bold;" onkeyup="handleLineInput('D', this.value)" onchange="handleLineInput('D', this.value)">
                            <div class="custom-dropdown" id="dropdownD">
                                <div class="dropdown-selected" onclick="toggleDropdown('D')"><span>(optional)</span><span style="margin-left:auto;color:#4ecca3;">‚ñº</span></div>
                                <div class="dropdown-options" id="optionsD"></div>
                                <input type="hidden" id="manualCompareLineD" value="">
                            </div>
                        </div>
                    </div>
                    <div>
                        <label style="color:#ccc; font-size:12px; display:block; margin-bottom:5px;">Line E:</label>
                        <div style="display:flex; gap:5px; align-items:center;">
                            <input type="text" id="lineInputE" placeholder="#" maxlength="2" style="width:40px; padding:8px 4px; border-radius:5px; background:#16213e; color:#4ecca3; border:1px solid #4ecca3; font-size:14px; text-align:center; font-weight:bold;" onkeyup="handleLineInput('E', this.value)" onchange="handleLineInput('E', this.value)">
                            <div class="custom-dropdown" id="dropdownE">
                                <div class="dropdown-selected" onclick="toggleDropdown('E')"><span>(optional)</span><span style="margin-left:auto;color:#4ecca3;">‚ñº</span></div>
                                <div class="dropdown-options" id="optionsE"></div>
                                <input type="hidden" id="manualCompareLineE" value="">
                            </div>
                        </div>
                    </div>
                    <button class="btn" onclick="showManualComparison()" style="background:#e94560; color:#fff; padding:8px 20px;">Compare Lines</button>
                    <button class="btn" onclick="clearManualComparison()" style="background:#888; color:#fff; padding:8px 20px;">Clear</button>
                </div>
                <div id="manualCompareView" style="display:none; margin-top:15px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <h4 style="color:#4ecca3; margin:0;">Comparison View</h4>
                        <button class="btn" onclick="printManualComparison()" style="background:#9b59b6; color:#fff; padding:5px 15px; font-size:12px;">üñ®Ô∏è Print</button>
                    </div>
                    <div id="manualCompareContent" style="background:#16213e; padding:10px; border-radius:5px; overflow-x:auto;"></div>
                </div>
            </div>

            <div style="display:flex; gap:10px; margin-bottom:15px; flex-wrap:wrap; align-items:center; justify-content:space-between;">
                <div style="display:flex; gap:10px;">
                    <button class="btn" onclick="showSwapCategory('fiveSevenOff')" id="btn-fiveSevenOff" style="background:#4ecca3; color:#1a1a2e;">5 On / 7 Off</button>
                    <button class="btn" onclick="showSwapCategory('twoDayPickup')" id="btn-twoDayPickup" style="background:#0f3460; color:#eee;">2-Day Pickup Swap</button>
                </div>
                <button class="btn" onclick="printSwapCompare()" style="background:#9b59b6; color:#fff; padding:5px 15px; font-size:12px;">üñ®Ô∏è Print</button>
            </div>
            <div id="swapCompareContent"></div>
        </div>
    </div>

    <!-- ASCENT Export Modal -->
    <div class="modal-overlay" id="ascentExportModal" onclick="hideAscentExport()">
        <div class="modal" style="max-width:900px; width:95vw; max-height:90vh;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideAscentExport()">Close</button>
            <h3>üì§ ASCENT Schedule Export</h3>
            
            <!-- Collapsible Instructions -->
            <details style="background:#1a1a2e; border:1px solid #4ecca3; border-radius:8px; margin-bottom:15px; padding:10px;">
                <summary style="color:#4ecca3; font-weight:bold; cursor:pointer; padding:5px;">üìã CLICK HERE FOR STEP-BY-STEP INSTRUCTIONS</summary>
                <div style="margin-top:15px; color:#ccc; font-size:12px; line-height:1.8;">
                    <h4 style="color:#f0a500; margin-bottom:10px;">üéØ WHAT THIS DOES:</h4>
                    <p style="margin-bottom:15px;">Creates a CSV file that ASCENT can import with everyone's work schedule for the entire bid year (Apr 1, 2026 - Mar 31, 2027).</p>
                    
                    <h4 style="color:#f0a500; margin-bottom:10px;">üìù BEFORE YOU START - GET EMPLOYEE DATA:</h4>
                    <ol style="margin-left:20px; margin-bottom:15px;">
                        <li style="margin-bottom:8px;"><strong>Open ASCENT</strong> or your employee database</li>
                        <li style="margin-bottom:8px;"><strong>Export/copy a list</strong> with these 5 columns (tab-separated):
                            <ul style="margin-left:20px; margin-top:5px; list-style-type:disc;">
                                <li><span style="color:#4ecca3;">ABBREVIATED_NAME</span> - e.g., "PAWL, CHR" (must match bid program format)</li>
                                <li><span style="color:#4ecca3;">FULL_NAME</span> - e.g., "Pawlowski, Chris"</li>
                                <li><span style="color:#4ecca3;">WORKER_ID</span> - e.g., "084042200"</li>
                                <li><span style="color:#4ecca3;">WORKER_TYPE</span> - e.g., "SSOM" or "SOM"</li>
                                <li><span style="color:#4ecca3;">HIRE_TYPE</span> - e.g., "Full Time"</li>
                            </ul>
                        </li>
                    </ol>
                    
                    <h4 style="color:#f0a500; margin-bottom:10px;">üöÄ EXPORT STEPS:</h4>
                    <ol style="margin-left:20px; margin-bottom:15px;">
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 1:</strong> Paste your employee data (from above) into the text box below</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 2:</strong> Click <strong>"Parse Data"</strong> button - it will show how many employees were found</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 3:</strong> Click <strong>"Generate Preview"</strong> button - this creates the export and shows a preview</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 4:</strong> Check for any <span style="color:#e94560;">red "Unmatched Names"</span> warnings - these are people in the bid who weren't found in your pasted data (typos or missing employees)</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 5:</strong> Click <strong>"Download CSV File"</strong> - saves to your Downloads folder</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">STEP 6:</strong> Import the CSV file into ASCENT</li>
                    </ol>
                    
                    <h4 style="color:#f0a500; margin-bottom:10px;">‚ö†Ô∏è TROUBLESHOOTING:</h4>
                    <ul style="margin-left:20px; list-style-type:disc;">
                        <li style="margin-bottom:5px;"><strong>Unmatched names?</strong> The abbreviated name in employee data must EXACTLY match the bid program (e.g., "PAWL, CHR" not "PAWL,CHR" or "PAWL, CHRIS")</li>
                        <li style="margin-bottom:5px;"><strong>Wrong columns?</strong> Make sure data is tab-separated (copy from Excel/ASCENT usually works)</li>
                        <li style="margin-bottom:5px;"><strong>Missing people?</strong> Only people with bid assignments will be in the export</li>
                    </ul>
                </div>
            </details>
            
            <p style="color:#888; font-size:12px; margin-bottom:15px;">
                Export bid assignments with full 365-day schedules (Apr 1, 2026 - Mar 31, 2027).
                <br><strong style="color:#4ecca3;">Paste employee data below ‚Äî it stays in your browser only, never saved to web.</strong>
            </p>
            
            <!-- Step 1: Paste Employee Data -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 1: Paste Employee Data</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">
                    Paste tab-separated data with columns: ABBREVIATED_NAME, FULL_NAME, WORKER_ID, WORKER_TYPE, HIRE_TYPE
                </p>
                <textarea id="employeeDataPaste" rows="6" placeholder="ABBREVIATED_NAME	FULL_NAME	WORKER_ID	WORKER_TYPE	HIRE_TYPE
PAWL, CHR	Pawlowski, Chris	084042200	SSOM	Full Time
GWIN, BRI	Gwinn, Brian	095403300	SOM	Full Time
..."
                    style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:10px; font-family:monospace; font-size:11px; resize:vertical;"></textarea>
                <div style="display:flex; gap:10px; align-items:center; margin-top:10px;">
                    <button class="btn" onclick="parseEmployeeData()" style="background:#4ecca3; color:#1a1a2e;">Parse Data</button>
                    <span id="employeeParseStatus" style="color:#888; font-size:12px;"></span>
                </div>
            </div>
            
            <!-- Step 2: Generate Export -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 2: Generate ASCENT Export</h4>
                <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
                    <button class="btn" onclick="generateAscentExport()" id="generateExportBtn" disabled 
                            style="background:#888; color:#fff;">Generate Preview</button>
                    <button class="btn" onclick="downloadAscentExport()" id="downloadExportBtn" disabled 
                            style="background:#888; color:#fff;">‚¨áÔ∏è Download CSV File</button>
                </div>
            </div>
            
            <!-- Preview Area -->
            <div id="ascentExportPreview" style="display:none;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Export Preview</h4>
                <div style="display:flex; gap:15px; margin-bottom:10px; font-size:12px;">
                    <span style="color:#4ecca3;">‚úì Matched: <span id="matchedCount">0</span></span>
                    <span style="color:#e94560;">‚úó Unmatched: <span id="unmatchedCount">0</span></span>
                    <span style="color:#888;">Total Assignments: <span id="totalAssignments">0</span></span>
                </div>
                <div id="unmatchedWarning" style="display:none; background:#e9456033; border:1px solid #e94560; padding:10px; border-radius:5px; margin-bottom:10px;">
                    <strong style="color:#e94560;">‚ö†Ô∏è Unmatched Names:</strong>
                    <p style="color:#ccc; font-size:11px; margin-top:5px;">These abbreviated names weren't found in your pasted data:</p>
                    <div id="unmatchedList" style="color:#e94560; font-size:12px; font-family:monospace; margin-top:5px;"></div>
                </div>
                <p style="color:#888; font-size:11px; margin-bottom:5px;">Preview (showing first 2 days of 365):</p>
                <div style="max-height:300px; overflow-y:auto; background:#16213e; border-radius:5px; padding:10px;">
                    <table style="width:100%; font-size:11px; border-collapse:collapse;">
                        <thead>
                            <tr style="color:#4ecca3; text-align:left; border-bottom:1px solid #0f3460;">
                                <th style="padding:5px;">Status</th>
                                <th style="padding:5px;">Worker</th>
                                <th style="padding:5px;">Worker ID</th>
                                <th style="padding:5px;">Type</th>
                                <th style="padding:5px;">Line#</th>
                                <th style="padding:5px;">Apr 1</th>
                                <th style="padding:5px;">Apr 2</th>
                            </tr>
                        </thead>
                        <tbody id="ascentExportTable"></tbody>
                    </table>
                </div>
                <p style="color:#666; font-size:10px; margin-top:10px;">
                    Full export includes: Header block + 365 date columns (Apr 1, 2026 - Mar 31, 2027)
                </p>
            </div>
        </div>
    </div>

    <!-- May Summary Modal -->
    <div class="modal-overlay" id="maySummaryModal" onclick="hideMaySummary()">
        <div class="modal" style="max-width:1200px; width:95vw; max-height:90vh; overflow-y:auto;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideMaySummary()">Close</button>
            <h3>üìã May Balance Summary</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">
                Alphabetical listing of all assigned lines with May 2026 shifts. Override days are <span style="background:#f39c12; color:#1a1a2e; padding:2px 5px; border-radius:3px;">highlighted</span>.
            </p>
            
            <div style="display:flex; gap:10px; margin-bottom:15px;">
                <button class="btn" onclick="generateMaySummary()" style="background:#4ecca3; color:#1a1a2e;">üîÑ Generate Summary</button>
                <button class="btn" onclick="printMaySummary()" id="printMaySummaryBtn" disabled style="background:#888; color:#fff;">üñ®Ô∏è Print Report</button>
            </div>
            
            <div id="maySummaryContent" style="display:none;">
                <!-- Combined SSOM + SOM Section (sorted alphabetically) -->
                <div style="margin-bottom:30px;">
                    <h4 style="color:#e94560; margin-bottom:10px; border-bottom:2px solid #e94560; padding-bottom:5px;">All Assignments (SSOM + SOM) - Sorted Alphabetically</h4>
                    <div style="overflow-x:auto;">
                        <table id="maySummaryCombined" style="width:100%; font-size:11px; border-collapse:collapse; background:#16213e;">
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PTO Overlay Modal -->
    <div class="modal-overlay" id="ptoModal" onclick="hidePTOModal()">
        <div class="modal" style="max-width:600px;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hidePTOModal()">Close</button>
            <h3>üèñÔ∏è PTO Overlay</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">
                Enter your planned PTO dates to see conflicts with each line. Data is stored locally in your browser.
            </p>
            
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Add PTO Range</h4>
                <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Start Date:</label>
                        <input type="date" id="ptoStartDate" min="2026-04-01" max="2027-03-31" 
                            style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3;">
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">End Date:</label>
                        <input type="date" id="ptoEndDate" min="2026-04-01" max="2027-03-31"
                            style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3;">
                    </div>
                    <button class="btn" onclick="addPTORange()" style="background:#4ecca3; color:#1a1a2e;">+ Add</button>
                </div>
            </div>
            
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Your PTO Dates</h4>
                <div id="ptoDatesList" style="max-height:150px; overflow-y:auto;">
                    <p style="color:#888; font-size:12px;">No PTO dates added yet.</p>
                </div>
            </div>
            
            <div style="display:flex; gap:10px; justify-content:space-between;">
                <div>
                    <span style="color:#888; font-size:11px;">PTO days will be highlighted in <span style="color:#2563eb; font-weight:bold;">blue</span> on calendars</span>
                </div>
                <div>
                    <button class="btn" onclick="clearAllPTO()" style="background:#e94560; color:white;">Clear All PTO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Audit Log Modal -->
    <div class="modal-overlay" id="auditLogModal" onclick="hideAuditLog()">
        <div class="modal" style="max-width:800px; max-height:80vh;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideAuditLog()">Close</button>
            <h3>üìã Bid Audit Log</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">
                History of all bid assignments and changes.
            </p>
            
            <div style="display:flex; gap:10px; margin-bottom:15px;">
                <button class="btn" onclick="refreshAuditLog()" style="background:#4ecca3; color:#1a1a2e;">‚ü≥ Refresh</button>
                <button class="btn" onclick="exportAuditLog()" style="background:#2563eb; color:white;">‚¨áÔ∏è Export CSV</button>
            </div>
            
            <div style="background:#0f3460; padding:15px; border-radius:8px; max-height:400px; overflow-y:auto;">
                <table style="width:100%; border-collapse:collapse; font-size:12px;">
                    <thead>
                        <tr style="color:#4ecca3; text-align:left; border-bottom:2px solid #16213e; position:sticky; top:0; background:#0f3460;">
                            <th style="padding:8px;">Time</th>
                            <th style="padding:8px;">Action</th>
                            <th style="padding:8px;">Person</th>
                            <th style="padding:8px;">Line</th>
                            <th style="padding:8px;">By</th>
                        </tr>
                    </thead>
                    <tbody id="auditLogTable">
                        <tr><td colspan="5" style="padding:20px; text-align:center; color:#888;">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Next Year Setup Modal -->
    <div class="modal-overlay" id="nextYearSetupModal" onclick="hideNextYearSetup()">
        <div class="modal" style="max-width:1000px; width:95vw; max-height:90vh; overflow-y:auto;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideNextYearSetup()">Close</button>
            <h3>‚öôÔ∏è Next Year Setup</h3>
            
            <!-- Master Instructions - Collapsible -->
            <details open style="background:linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border:2px solid #9b59b6; border-radius:10px; margin-bottom:20px; padding:15px;">
                <summary style="color:#9b59b6; font-weight:bold; font-size:16px; cursor:pointer; padding:5px;">üìã MASTER INSTRUCTIONS - READ THIS FIRST!</summary>
                <div style="margin-top:15px; color:#ccc; font-size:13px; line-height:1.8;">
                    <div style="background:#e9456033; border-left:4px solid #e94560; padding:10px; margin-bottom:15px; border-radius:0 5px 5px 0;">
                        <strong style="color:#e94560;">‚ö†Ô∏è IMPORTANT:</strong> Only use this ONCE per year, BEFORE the new bid year starts. This will generate new configuration files for the program.
                    </div>
                    
                    <h4 style="color:#f0a500; margin:15px 0 10px 0;">üéØ WHAT YOU'LL NEED BEFORE STARTING:</h4>
                    <ol style="margin-left:20px; margin-bottom:15px;">
                        <li style="margin-bottom:8px;">üìä <strong>Updated Seniority List</strong> - Excel/spreadsheet with current SSOM and SOM bidders in seniority order</li>
                        <li style="margin-bottom:8px;">üìã <strong>Line Patterns</strong> - Your Excel with all 95 lines and their 12-day work patterns</li>
                        <li style="margin-bottom:8px;">üìÖ <strong>Bid Start Date</strong> - The official date and time bidding begins</li>
                        <li style="margin-bottom:8px;">üèà <strong>Super Bowl Date</strong> - Verify the actual date (NFL announces ~2 years ahead)</li>
                    </ol>
                    
                    <h4 style="color:#f0a500; margin:15px 0 10px 0;">üöÄ STEPS TO SET UP NEW BID YEAR:</h4>
                    <ol style="margin-left:20px;">
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 1:</strong> Select the new bid year from dropdown below</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 2:</strong> Verify the Super Bowl date is correct (check NFL schedule)</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 3:</strong> Enter bid start date, time, and interval</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 4:</strong> Paste your SSOM seniority list</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 5:</strong> Paste your SOM seniority list</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 6:</strong> Paste your line patterns</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 7:</strong> Click "Generate Preview" to verify everything</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 8:</strong> Download the generated files</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 9:</strong> Use May Balance tool to create overrides (after patterns are set)</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Step 10:</strong> Replace files on GitHub and clear Firebase data</li>
                    </ol>
                </div>
            </details>

            <!-- Section 1: Bid Year Selection -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 1: Select Bid Year</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">Choose the bid year. Holidays will auto-populate (April 1 to March 31).</p>
                <div style="display:flex; gap:15px; align-items:center; flex-wrap:wrap;">
                    <select id="setupBidYear" onchange="loadHolidaysForYear()" style="padding:10px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3; font-size:14px;">
                        <option value="">-- Select Bid Year --</option>
                    </select>
                    <span id="bidYearInfo" style="color:#888; font-size:12px;"></span>
                </div>
            </div>

            <!-- Section 2: Super Bowl Verification -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 2: Verify Super Bowl Date üèà</h4>
                <div style="background:#f0a50033; border-left:4px solid #f0a500; padding:10px; margin-bottom:10px; border-radius:0 5px 5px 0;">
                    <strong style="color:#f0a500;">‚ö†Ô∏è VERIFY THIS!</strong>
                    <span style="color:#ccc; font-size:12px;"> The Super Bowl date below is projected. Check the actual NFL schedule to confirm!</span>
                </div>
                <div style="display:flex; gap:15px; align-items:center; flex-wrap:wrap;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Super Bowl Date:</label>
                        <input type="date" id="setupSuperBowlDate" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #f0a500;">
                    </div>
                    <div id="superBowlDayOfWeek" style="color:#f0a500; font-size:14px; font-weight:bold;"></div>
                </div>
            </div>

            <!-- Section 3: Bid Schedule -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 3: Bid Schedule Settings</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">The bid schedule will be auto-generated from the seniority lists.</p>
                <div style="display:flex; gap:15px; align-items:flex-end; flex-wrap:wrap;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Bid Start Date:</label>
                        <input type="date" id="setupBidStartDate" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3;">
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Start Time:</label>
                        <input type="time" id="setupBidStartTime" value="05:00" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3;">
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Interval (minutes):</label>
                        <input type="number" id="setupBidInterval" value="10" min="5" max="60" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3; width:80px;">
                    </div>
                </div>
            </div>

            <!-- Section 4: SSOM Seniority List -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 4: SSOM Seniority List</h4>
                <details style="margin-bottom:10px;">
                    <summary style="color:#888; font-size:11px; cursor:pointer;">üìñ Click for format instructions</summary>
                    <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-top:10px; font-size:11px; color:#ccc;">
                        <p><strong>Paste from Excel with these columns (tab-separated):</strong></p>
                        <p style="color:#4ecca3; font-family:monospace; margin:10px 0;">Rank &nbsp;&nbsp; Name</p>
                        <p><strong>Example:</strong></p>
                        <pre style="color:#4ecca3; font-family:monospace; background:#16213e; padding:10px; border-radius:3px; overflow-x:auto;">1	COST, BOB
2	BRET, KEN
3	ASTL, JOE</pre>
                        <p style="margin-top:10px;"><strong>Name format:</strong> LAST, FIR (4 letters last name, 3 letters first name)</p>
                        <p>Use <strong>(VACANT)</strong> for empty slots</p>
                    </div>
                </details>
                <textarea id="setupSSOMList" rows="6" placeholder="Paste SSOM seniority list here...
1	COST, BOB
2	BRET, KEN
..."
                    style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:10px; font-family:monospace; font-size:11px; resize:vertical;"></textarea>
                <div style="display:flex; gap:10px; align-items:center; margin-top:10px;">
                    <button class="btn" onclick="parseSSOMList()" style="background:#4ecca3; color:#1a1a2e;">Parse SSOM</button>
                    <span id="ssomParseStatus" style="color:#888; font-size:12px;"></span>
                </div>
            </div>

            <!-- Section 5: SOM Seniority List -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 5: SOM Seniority List</h4>
                <details style="margin-bottom:10px;">
                    <summary style="color:#888; font-size:11px; cursor:pointer;">üìñ Click for format instructions</summary>
                    <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-top:10px; font-size:11px; color:#ccc;">
                        <p><strong>Same format as SSOM - paste from Excel (tab-separated):</strong></p>
                        <p style="color:#4ecca3; font-family:monospace; margin:10px 0;">Rank &nbsp;&nbsp; Name</p>
                        <p><strong>Example:</strong></p>
                        <pre style="color:#4ecca3; font-family:monospace; background:#16213e; padding:10px; border-radius:3px; overflow-x:auto;">1	BIRD, DAN
2	FRAN, DAV
3	CHAR, CAR</pre>
                    </div>
                </details>
                <textarea id="setupSOMList" rows="8" placeholder="Paste SOM seniority list here...
1	BIRD, DAN
2	FRAN, DAV
..."
                    style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:10px; font-family:monospace; font-size:11px; resize:vertical;"></textarea>
                <div style="display:flex; gap:10px; align-items:center; margin-top:10px;">
                    <button class="btn" onclick="parseSOMList()" style="background:#4ecca3; color:#1a1a2e;">Parse SOM</button>
                    <span id="somParseStatus" style="color:#888; font-size:12px;"></span>
                </div>
            </div>

            <!-- Section 6: Line Patterns -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 6: Line Patterns (All 95 Lines)</h4>
                <details style="margin-bottom:10px;">
                    <summary style="color:#888; font-size:11px; cursor:pointer;">üìñ Click for format instructions</summary>
                    <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-top:10px; font-size:11px; color:#ccc;">
                        <p><strong>Paste from Excel with these columns (tab-separated):</strong></p>
                        <p style="color:#4ecca3; font-family:monospace; margin:10px 0;">LineNbr &nbsp; Desc &nbsp; Day1 &nbsp; Day2 &nbsp; Day3 &nbsp; Day4 &nbsp; Day5 &nbsp; Day6 &nbsp; Day7 &nbsp; Day8 &nbsp; Day9 &nbsp; Day10 &nbsp; Day11 &nbsp; Day12 &nbsp; ColorCode</p>
                        <p><strong>Example:</strong></p>
                        <pre style="color:#4ecca3; font-family:monospace; background:#16213e; padding:10px; border-radius:3px; overflow-x:auto;">1	SSOM	--	--	E05A	E05A	E05A	--	--	--	E05A	E05A	--	--	1
2	SSOM	E05A	E05A	--	--	--	E05A	E05A	E05A	--	--	--	--	1
3	SSOM	--	--	A06M	A06M	A06M	--	--	--	A06M	A06M	--	--	1</pre>
                        <p style="margin-top:10px;"><strong>Day values:</strong> Shift code (e.g., E05A, A06M, P12B) or "--" for off</p>
                        <p><strong>ColorCode:</strong> 1=Gold, 2=Cyan, 3=Blue, 4=Red, 5=Pink, 6=Gray, 7=Yellow, 8=Green, 9=Magenta, 99=Purple</p>
                    </div>
                </details>
                <textarea id="setupLinePatterns" rows="10" placeholder="Paste line patterns here...
1	SSOM	--	--	E05A	E05A	E05A	--	--	--	E05A	E05A	--	--	1
2	SSOM	E05A	E05A	--	--	--	E05A	E05A	E05A	--	--	--	--	1
..."
                    style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:10px; font-family:monospace; font-size:11px; resize:vertical;"></textarea>
                <div style="display:flex; gap:10px; align-items:center; margin-top:10px;">
                    <button class="btn" onclick="parseLinePatterns()" style="background:#4ecca3; color:#1a1a2e;">Parse Lines</button>
                    <span id="linePatternsParseStatus" style="color:#888; font-size:12px;"></span>
                </div>
            </div>

            <!-- Section 7: May Balance Tool Link -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 9: May Overrides (Balance to 152 Days)</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">
                    After generating the new files, use the May Balance tool to calculate and create the override adjustments needed to balance each line to 152 work days.
                </p>
                <a href="may_balance.html" target="_blank" class="btn" style="background:#f0a500; color:#1a1a2e; text-decoration:none; display:inline-block;">üîß Open May Balance Tool</a>
            </div>

            <!-- Section 8: Generate & Preview -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 7 & 8: Generate Files</h4>
                <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:15px;">
                    <button class="btn" onclick="generateNextYearPreview()" id="generatePreviewBtn" style="background:#4ecca3; color:#1a1a2e;">üîç Generate Preview</button>
                    <button class="btn" onclick="downloadGeneratedFiles()" id="downloadFilesBtn" disabled style="background:#888; color:#fff;">‚¨áÔ∏è Download All Files</button>
                </div>
                
                <!-- Preview Area -->
                <div id="setupPreviewArea" style="display:none;">
                    <h5 style="color:#f0a500; margin-bottom:10px;">Preview Summary:</h5>
                    <div id="setupPreviewContent" style="background:#1a1a2e; padding:15px; border-radius:5px; font-size:12px; max-height:300px; overflow-y:auto;"></div>
                </div>
            </div>

            <!-- Section 10: Firebase Reset -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; border:2px solid #e94560;">
                <h4 style="color:#e94560; margin-bottom:10px;">Step 10: Clear Firebase Data (New Year Reset)</h4>
                <div style="background:#e9456033; border-left:4px solid #e94560; padding:10px; margin-bottom:10px; border-radius:0 5px 5px 0;">
                    <strong style="color:#e94560;">‚ö†Ô∏è DANGER ZONE!</strong>
                    <span style="color:#ccc; font-size:12px;"> This will permanently delete ALL current bid assignments, history, and rollback data. Only do this when starting a fresh bid year!</span>
                </div>
                <button class="btn" onclick="confirmClearFirebase()" style="background:#e94560; color:white;">üóëÔ∏è Clear All Firebase Data</button>
            </div>

            <!-- Holidays Preview (auto-populated) -->
            <div id="holidaysPreviewSection" style="display:none; background:#0f3460; padding:15px; border-radius:8px; margin-top:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">üìÖ Holidays for Selected Bid Year</h4>
                <div id="holidaysPreviewContent" style="font-size:12px;"></div>
            </div>
        </div>
    </div>

    <!-- Escalation Manager Modal -->
    <div class="modal-overlay" id="escalationModal" onclick="hideEscalationManager()">
        <div class="modal" style="max-width:1000px; width:95vw; max-height:90vh; overflow-y:auto;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideEscalationManager()">Close</button>
            <h3>üîÑ Escalation Manager</h3>
            
            <!-- Master Instructions -->
            <details style="background:linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border:2px solid #f39c12; border-radius:10px; margin-bottom:20px; padding:15px;">
                <summary style="color:#f39c12; font-weight:bold; font-size:16px; cursor:pointer; padding:5px;">üìã ESCALATION INSTRUCTIONS - READ THIS FIRST!</summary>
                <div style="margin-top:15px; color:#ccc; font-size:13px; line-height:1.8;">
                    <h4 style="color:#f39c12; margin:15px 0 10px 0;">üéØ WHAT IS AN ESCALATION?</h4>
                    <p style="margin-bottom:15px;">When someone leaves (promotion, transfer, etc.), their line becomes vacant. An escalation bid allows everyone below to bid for the vacant line(s), creating a ripple effect of movements.</p>
                    
                    <h4 style="color:#f39c12; margin:15px 0 10px 0;">üìù ESCALATION PROCESS:</h4>
                    <ol style="margin-left:20px; margin-bottom:15px;">
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 1 - Announce:</strong> Mark lines as vacant, set deadline, activate banner</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 2 - Wait:</strong> Users view vacancies and email their preferences to scheduling</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 3 - Process:</strong> Scheduling processes bids and determines results</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 4 - Update:</strong> Paste new seniority lists, apply assignment results</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 5 - Download:</strong> Download updated files and upload to GitHub</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 6 - Export:</strong> Generate new ASCENT file with changes</li>
                        <li style="margin-bottom:8px;"><strong style="color:#4ecca3;">Phase 7 - Complete:</strong> Click "Apply Changes & Complete Escalation"</li>
                    </ol>
                    
                    <h4 style="color:#f39c12; margin:15px 0 10px 0;">üìÅ FILES THAT NEED UPDATING:</h4>
                    <p style="margin-bottom:10px;">After an escalation, these 4 files need to be updated on GitHub with new seniority lists:</p>
                    <ul style="margin-left:20px; list-style-type:disc; margin-bottom:15px;">
                        <li style="margin-bottom:5px;"><strong>bidding_final.js</strong> - Main program (GROUP1 & GROUP2)</li>
                        <li style="margin-bottom:5px;"><strong>bid_confirmation.html</strong> - Confirmation status page</li>
                        <li style="margin-bottom:5px;"><strong>bid_times.html</strong> - Bid schedule page</li>
                        <li style="margin-bottom:5px;"><strong>swap_builder.html</strong> - Swap tool</li>
                    </ul>
                    <p style="color:#4ecca3;">Use the "Download All Updated Files" button in the Export section to get these files!</p>
                    
                    <h4 style="color:#f39c12; margin:15px 0 10px 0;">‚ö†Ô∏è IMPORTANT NOTES:</h4>
                    <ul style="margin-left:20px; list-style-type:disc;">
                        <li style="margin-bottom:5px;">Existing assignments are preserved - only changed lines are updated</li>
                        <li style="margin-bottom:5px;">New people can be added to seniority list at any position</li>
                        <li style="margin-bottom:5px;">New lines can be added if needed (paste full 12-day pattern)</li>
                        <li style="margin-bottom:5px;">Both SSOM and SOM can have escalations at the same time (same deadline)</li>
                    </ul>
                </div>
            </details>

            <!-- Current Escalation Status -->
            <div id="escalationStatusSection" style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Current Escalation Status</h4>
                <div id="escalationCurrentStatus" style="font-size:14px; color:#888;">No active escalation</div>
            </div>

            <!-- Section 1: Start/Configure Escalation -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f39c12; margin-bottom:10px;">Step 1: Configure Escalation</h4>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Deadline Date:</label>
                        <input type="date" id="escalationDeadlineDate" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #f39c12; width:100%;">
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Deadline Time:</label>
                        <input type="time" id="escalationDeadlineTime" value="17:00" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #f39c12; width:100%;">
                    </div>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Instructions/Message for Users:</label>
                    <textarea id="escalationMessage" rows="2" placeholder="Email your preferences to scheduling@company.com" style="width:100%; padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #f39c12; resize:vertical;"></textarea>
                </div>
                <div style="margin-bottom:15px;">
                    <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">Groups with Vacancies:</label>
                    <div style="display:flex; gap:20px;">
                        <label style="color:#fff; cursor:pointer;"><input type="checkbox" id="escalationSSOM"> SSOM</label>
                        <label style="color:#fff; cursor:pointer;"><input type="checkbox" id="escalationSOM"> SOM</label>
                    </div>
                </div>
            </div>

            <!-- Section 2: Mark Vacant Lines -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f39c12; margin-bottom:10px;">Step 2: Mark Vacant Lines</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">Enter line numbers that are becoming vacant (comma-separated). The person holding that line will be removed.</p>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">SSOM Vacant Lines:</label>
                        <input type="text" id="escalationVacantSSOM" placeholder="e.g., 5, 12" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3; width:100%;">
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">SOM Vacant Lines:</label>
                        <input type="text" id="escalationVacantSOM" placeholder="e.g., 42, 58, 73" style="padding:8px; border-radius:5px; background:#16213e; color:#fff; border:1px solid #4ecca3; width:100%;">
                    </div>
                </div>
                <div style="margin-top:15px; display:flex; gap:10px;">
                    <button class="btn" onclick="previewVacancies()" style="background:#4ecca3; color:#1a1a2e;">üëÅÔ∏è Preview Vacancies</button>
                    <button class="btn" onclick="activateEscalation()" style="background:#f39c12; color:#1a1a2e;">üöÄ Activate Escalation</button>
                </div>
                <div id="vacancyPreview" style="display:none; margin-top:15px; padding:10px; background:#1a1a2e; border-radius:5px;"></div>
            </div>

            <!-- Section 3: Update Seniority Lists (After Escalation Bids Processed) -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f39c12; margin-bottom:10px;">Step 3: Update Seniority Lists (After Bids Processed)</h4>
                <details style="margin-bottom:10px;">
                    <summary style="color:#888; font-size:11px; cursor:pointer;">üìñ Click for format instructions</summary>
                    <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-top:10px; font-size:11px; color:#ccc;">
                        <p><strong>Paste the COMPLETE new seniority list:</strong></p>
                        <pre style="color:#4ecca3; font-family:monospace; background:#16213e; padding:10px; border-radius:3px;">1	COST, BOB
2	BRET, KEN
3	NEWP, GUY
4	ASTL, JOE</pre>
                        <p style="margin-top:10px;">Include ALL people, in new seniority order. Existing line assignments will be preserved for people who haven't changed.</p>
                    </div>
                </details>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">New SSOM Seniority List:</label>
                        <textarea id="escalationNewSSOM" rows="6" placeholder="Paste complete new SSOM list..." style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:8px; font-family:monospace; font-size:11px;"></textarea>
                        <button class="btn" onclick="parseEscalationSSOM()" style="background:#4ecca3; color:#1a1a2e; margin-top:5px;">Parse SSOM</button>
                        <span id="escalationSSOMStatus" style="margin-left:10px; font-size:12px;"></span>
                    </div>
                    <div>
                        <label style="color:#888; font-size:11px; display:block; margin-bottom:5px;">New SOM Seniority List:</label>
                        <textarea id="escalationNewSOM" rows="6" placeholder="Paste complete new SOM list..." style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:8px; font-family:monospace; font-size:11px;"></textarea>
                        <button class="btn" onclick="parseEscalationSOM()" style="background:#4ecca3; color:#1a1a2e; margin-top:5px;">Parse SOM</button>
                        <span id="escalationSOMStatus" style="margin-left:10px; font-size:12px;"></span>
                    </div>
                </div>
            </div>

            <!-- Section 4: Add New Lines (If Needed) -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f39c12; margin-bottom:10px;">Step 4: Add New Lines (If Needed)</h4>
                <details style="margin-bottom:10px;">
                    <summary style="color:#888; font-size:11px; cursor:pointer;">üìñ Click for format instructions</summary>
                    <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-top:10px; font-size:11px; color:#ccc;">
                        <p><strong>Only use this if adding NEW line numbers to the schedule:</strong></p>
                        <pre style="color:#4ecca3; font-family:monospace; background:#16213e; padding:10px; border-radius:3px; overflow-x:auto;">96	SOM	--	--	E05A	E05A	E05A	--	--	--	E05A	E05A	--	--	1</pre>
                        <p style="margin-top:10px;">Format: LineNbr, Desc, Day1-Day12, ColorCode (tab-separated)</p>
                    </div>
                </details>
                <textarea id="escalationNewLines" rows="3" placeholder="Only if adding NEW line numbers... (leave blank if not needed)" style="width:100%; background:#16213e; color:#fff; border:1px solid #888; border-radius:5px; padding:8px; font-family:monospace; font-size:11px;"></textarea>
                <button class="btn" onclick="parseNewLines()" style="background:#888; color:#fff; margin-top:5px;">Parse New Lines</button>
                <span id="newLinesStatus" style="margin-left:10px; font-size:12px;"></span>
            </div>

            <!-- Section 5: Apply Escalation Results -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-bottom:15px;">
                <h4 style="color:#f39c12; margin-bottom:10px;">Step 5: Apply Escalation Results</h4>
                
                <!-- Option A: Paste Format -->
                <div style="background:#1a1a2e; padding:10px; border-radius:5px; margin-bottom:15px;">
                    <label style="color:#4ecca3; font-size:12px; display:block; margin-bottom:5px;"><strong>Option A:</strong> Paste Results (NAME ‚Üí Line#)</label>
                    <textarea id="escalationResults" rows="5" placeholder="BIRD, DAN ‚Üí 42
FRAN, DAV ‚Üí 58
NEWP, GUY ‚Üí 35" style="width:100%; background:#16213e; color:#fff; border:1px solid #4ecca3; border-radius:5px; padding:8px; font-family:monospace; font-size:11px;"></textarea>
                    <button class="btn" onclick="parseEscalationResults()" style="background:#4ecca3; color:#1a1a2e; margin-top:5px;">Parse & Preview Results</button>
                </div>
                
                <!-- Option B: Interactive -->
                <div style="background:#1a1a2e; padding:10px; border-radius:5px;">
                    <label style="color:#4ecca3; font-size:12px; display:block; margin-bottom:10px;"><strong>Option B:</strong> Interactive Assignment</label>
                    <button class="btn" onclick="showInteractiveAssignment()" style="background:#4ecca3; color:#1a1a2e;">Open Interactive Assignment Tool</button>
                </div>
                
                <!-- Results Preview -->
                <div id="escalationResultsPreview" style="display:none; margin-top:15px; padding:10px; background:#1a1a2e; border-radius:5px; max-height:200px; overflow-y:auto;"></div>
            </div>

            <!-- Section 6: Complete Escalation -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; border:2px solid #4ecca3;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Step 6: Complete Escalation</h4>
                <p style="color:#888; font-size:11px; margin-bottom:15px;">This will apply all changes, update assignments, remove the escalation banner, and save everything.</p>
                <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <button class="btn" onclick="applyEscalationChanges()" style="background:#4ecca3; color:#1a1a2e;">‚úì Apply Changes & Complete Escalation</button>
                    <button class="btn" onclick="cancelEscalation()" style="background:#e94560; color:white;">‚úó Cancel Escalation</button>
                </div>
            </div>

            <!-- Export Section -->
            <div style="background:#0f3460; padding:15px; border-radius:8px; margin-top:15px;">
                <h4 style="color:#4ecca3; margin-bottom:10px;">Export After Escalation</h4>
                <p style="color:#888; font-size:11px; margin-bottom:10px;">After completing escalation, download updated files for GitHub and export to ASCENT.</p>
                
                <div style="background:#1a1a2e; padding:15px; border-radius:5px; margin-bottom:15px;">
                    <h5 style="color:#f39c12; margin-bottom:10px;">üìÅ Download Updated Files for GitHub</h5>
                    <p style="color:#888; font-size:11px; margin-bottom:10px;">
                        After pasting new seniority lists above, click to download all files that need to be updated on GitHub.
                        These files will contain the new seniority lists with removed/added people.
                    </p>
                    <div style="display:flex; gap:10px; flex-wrap:wrap;">
                        <button class="btn" onclick="downloadAllEscalationFiles()" style="background:#f39c12; color:#1a1a2e;">‚¨áÔ∏è Download All Updated Files</button>
                    </div>
                    <div id="escalationFilesStatus" style="margin-top:10px; font-size:12px;"></div>
                </div>
                
                <button class="btn" onclick="hideEscalationManager(); showAscentExport();" style="background:#2563eb; color:white;">üì§ Open ASCENT Export</button>
            </div>
        </div>
    </div>

    <!-- Interactive Assignment Modal -->
    <div class="modal-overlay" id="interactiveAssignmentModal" onclick="hideInteractiveAssignment()">
        <div class="modal" style="max-width:800px; width:95vw; max-height:90vh; overflow-y:auto;" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="hideInteractiveAssignment()">Close</button>
            <h3>üìã Interactive Line Assignment</h3>
            <p style="color:#888; font-size:12px; margin-bottom:15px;">Select a line for each person. Only vacant/available lines are shown in dropdown.</p>
            
            <div id="interactiveAssignmentContent" style="max-height:500px; overflow-y:auto;">
                <!-- Generated content goes here -->
            </div>
            
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button class="btn" onclick="applyInteractiveAssignments()" style="background:#4ecca3; color:#1a1a2e;">‚úì Apply These Assignments</button>
                <button class="btn" onclick="hideInteractiveAssignment()" style="background:#888; color:white;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<!-- Firebase Configuration -->
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDD7V8bTZK8q7ADvR7rx56n9UDZs5O7PjU",
  authDomain: "bid2026-58308.firebaseapp.com",
  databaseURL: "https://bid2026-58308-default-rtdb.firebaseio.com",
  projectId: "bid2026-58308",
  storageBucket: "bid2026-58308.firebasestorage.app",
  messagingSenderId: "312871238158",
  appId: "1:312871238158:web:b880eea86e983d1dac9a5f"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
</script>

<!-- Your JavaScript -->
<script src="may_overrides.js"></script>
<script src="bidding_final.js"></script>
<script src="calendar_generator.js"></script>
</body>
</html>
